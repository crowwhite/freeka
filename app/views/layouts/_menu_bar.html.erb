<div class="navbar navbar-default">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <%= link_to 'Freeka', root_path, class: 'navbar-brand' %>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav">
      <% categories = Category.root.enabled.includes(:enabled_sub_categories) %>
      <% categories.each do |category| %>
        <li class="dropdown">
          <div class="custom">
            <%= render 'shared/requirement/category_link', locals: { category: category } %>
          </div>
          <!-- <div class="dropdown-toggle" data-toggle="dropdown"> -->
            <b class="caret" class="dropdown-toggle" data-toggle="dropdown"></b>
          <!-- </div> -->
          <ul class="dropdown-menu">
            <% category.enabled_sub_categories.each do |sub_category| %>
              <li><%= render 'shared/requirement/category_link', locals: { category: sub_category } %></li>
            <% end %>
          </ul>
        </li>
      <% end %>
    </ul>
    <% if @controller_action && @controller_action.split('#')[0] == 'admins/requirements' %>
      <% action = '/admins/requirements/search' %>
    <% else %>
      <% action = '/requirements/search' %>
    <% end %>

    <%= form_tag(action, method: :post, class: "navbar-form navbar-left") do %>
      <input type="text" name="requirement[search]" class="form-control col-lg-8" placeholder="Search">
      <%= hidden_field_tag 'requirement[controller_action]', @controller_action %>
      <%= submit_tag 'Search' %>
    <% end %>
    <ul class="nav navbar-nav navbar-right">
      <%= render 'shared/users/sign_up_in' %>
    </ul>
  </div>
</div>