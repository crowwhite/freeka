<%= javascript_include_tag 'sub_region_select' %>
<%= javascript_include_tag 'sub_category_select' %>
<div class="well bs-component">
  <%= form_for(@requirement, html: { class: 'form-horizontal', multipart: true }) do |f| %>
  <fieldset>
    <legend>Requirement</legend>
    <%= render 'shared/errors', locals: { object: @requirement } %>
      <div class="field form-group">
        <%= f.label :Category, for: :category_ids, class: 'col-lg-2 control-label' %>*
        <div class="col-lg-10">
          <%= f.collection_select(:category_ids, Category.roots.enabled, :id, :name, { prompt: 'Select Category' }, { name: 'requirement[category_ids][]', class: 'form-control'}) %>
        </div>
      </div>
      <div class="field form-group">
        <%= f.label :sub_category, class: 'col-lg-2 control-label' %>
        <div class="col-lg-10">
          <%= render 'categories/sub_categories', locals: { parent_id: f.object.category_ids.first, child_id: f.object.category_ids.last } %>
        </div>
      </div>

      <div class="field form-group">
        <%= f.label :title, class: 'col-lg-2 control-label' %>*
        <div class="col-lg-10">
          <%= f.text_field :title, class: 'form-control' %>
        </div>
      </div>
      <div class="field form-group">
        <%= f.label :details, class: 'col-lg-2 control-label' %>*
        <div class="col-lg-10">
          <%= f.text_area :details, class: 'form-control' %>
        </div>
      </div>
      <div class="field form-group">
        <%= f.label :Require_Before, for: :expiration_date, class: 'col-lg-2 control-label' %>*
        <div class="col-lg-10">
          <%= f.date_select :expiration_date, class: 'form-control' %>
        </div>
      </div>

      <div class="field">
        <%= f.fields_for :address do |a| %>

          <div class="field form-group">
            <%= a.label :street, class: 'col-lg-2 control-label' %>
            <div class="col-lg-10">
              <%= a.text_field :street, class: 'form-control' %>
            </div>
          </div>

          <div class="field form-group">
            <%= a.label :city, class: 'col-lg-2 control-label' %>*
            <div class="col-lg-10">
              <%= a.text_field :city, class: 'form-control' %>
            </div>  
          </div>

          <div class="field form-group">
            <%= a.label :country, for: :country_code, class: 'col-lg-2 control-label' %>*
            <div class="col-lg-10">
              <%= a.country_select :country_code, priority: %w(US CA), prompt: 'Please select a country', id: 'country_select', class: 'form-control' %>
            </div>
          </div>

          <div class="field form-group">
            <%= f.label :state, for: :state_code, class: 'col-lg-2 control-label' %>*
            <div id="subregion_select" class="col-lg-10">
              <%= render partial: 'addresses/sub_region_select', locals: {parent_region: a.object.country_code} %>
            </div>
          </div>

        <% end %>
      </div>
      <div class="field">
        <%= f.fields_for :attachments, (f.object.attachments if f.object.attachments.exists?) || f.object.attachments.build do |a| %>
          <div class="col-lg-10">
            <%= a.file_field :description, multiple: true, name: 'requirement[attachments_attributes][][description]', class: 'form-control' %>
          </div>
        <% end %>
      </div>
      <div class="field">
        <%= f.fields_for :image, f.object.image || f.object.build_image do |a| %>
          <div class="col-lg-10">
            <%= a.label :Image, for: :description, class: 'col-lg-2 control-label' %>
            <%= a.file_field :description, class: 'form-control' %>
          </div>
        <% end %>
      </div>

      <div class="actions btn btn-primary">
        <%= f.submit %>
      </div>
    </fieldset>
  <% end %>
</div>